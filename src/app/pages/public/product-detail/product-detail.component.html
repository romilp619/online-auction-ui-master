<div class="top-margin"></div>
<div class="container">
  <div class="card">
    <div class="container-fliud">
      <div class="wrapper row">
        <div class="preview col-md-6">

          <!--<<<<<< Updated upstream
                              </div>
                              <div class="details col-md-6">
                                  <h3 class="product-title">{{product.name}}</h3>
                                  <!<div class="rating">
                                      <div class="stars">
                                          <span class="fa fa-star checked"></span>
                                          <span class="fa fa-star checked"></span>
                                          <span class="fa fa-star checked"></span>
                                          <span class="fa fa-star"></span>
                                          <span class="fa fa-star"></span>
                                      </div>
                                      <span class="review-no">41 reviews</span>
                                  </div>>
                                  <p class="product-description">{{product.description}}</p>
                                  <h4 class="price">current price: <span>{{product.price}}</span></h4>
                                  <!<p class="vote"><strong>91%</strong> of buyers enjoyed this product! <strong>(87 votes)</strong></p>>
                                  <h5 class="sizes">Start Date:
                                      <span class="size" data-toggle="tooltip" title="small">{{product.startDate}}</span>
                                  </h5>
                                  <h5 class="colors">Start Time:
                                      <span class="size" data-toggle="tooltip" title="small">{{product.startTime}}</span>
                                  </h5>
                                  <h5 class="sizes">End Date:
                                      <span class="size" data-toggle="tooltip" title="small">{{product.endDate}}</span>
                                  </h5>
                                  <h5 class="colors">End Time:
                                      <span class="size" data-toggle="tooltip" title="small">{{product.endTime}}</span>
                                  </h5>
                                  <div class="action">
                                      <button mat-raised-button class="btn btn-default cart" type="button"> Cart </button>
                                      <button mat-icon-button color="warn" aria-label="Example icon-button with a heart icon">
                                      <a [routerLink]="['/bid-details']" routerLinkActive="router-link-active">
                                        <button mat-button class="header-font-color">Bid Details</button></a>
          ======= -->
          <div class="preview-pic tab-content " style="max-height: 400px; max-width: 500px;"
               style="vertical-align: middle;">
            <!--<div class="tab-pane active" id="pic-1"><img src="http://placekitten.com/400/252" />
                            </div>
                            <div class="tab-pane" id="pic-2"><img
                                    src="https://cdn.pixabay.com/photo/2017/09/25/13/12/dog-2785074__340.jpg" />
                            </div>
                            <div class="tab-pane" id="pic-3"><img
                                    src="https://cdn.pixabay.com/photo/2015/08/01/16/15/soldier-870399__340.jpg" />
                            </div>
                            <div class="tab-pane" id="pic-4"><img
                                    src="https://cdn.pixabay.com/photo/2018/03/31/06/31/dog-3277416__340.jpg" />
                            </div>
                            <div class="tab-pane" id="pic-5"><img
                                    src="https://cdn.pixabay.com/photo/2015/02/24/15/41/dog-647528__340.jpg" />
                            </div>-->
            <div class="tab-pane active" id="{{firstImageId}}">
              <img src="{{firstImageData}}" class="first-img" style="max-width: max-content; max-height: max-content;"/>
            </div>
            <div class="tab-pane" *ngFor="let imgIdData of otherIdImagesData" id="{{imgIdData.id}}">
              <img src="{{imgIdData.imageData}}" class="first-img"/>
            </div>
          </div>
          <ul class="preview-thumbnail nav nav-tabs">
            <!--<li class="active"><a data-target="#pic-1" data-toggle="tab"><img
                                        src="http://placekitten.com/200/126" /></a></li>
                            <li><a data-target="#pic-2" data-toggle="tab"><img
                                        src="https://cdn.pixabay.com/photo/2017/09/25/13/12/dog-2785074__340.jpg" /></a>
                            </li>
                            <li><a data-target="#pic-3" data-toggle="tab"><img
                                        src="https://cdn.pixabay.com/photo/2015/08/01/16/15/soldier-870399__340.jpg" /></a>
                            </li>
                            <li><a data-target="#pic-4" data-toggle="tab"><img
                                        src="https://cdn.pixabay.com/photo/2018/03/31/06/31/dog-3277416__340.jpg" /></a>
                            </li>
                            <li><a data-target="#pic-5" data-toggle="tab"><img
                                        src="https://cdn.pixabay.com/photo/2015/02/24/15/41/dog-647528__340.jpg" /></a>
                            </li>-->
            <li class="active"><a data-target="#{{firstImageId}}" data-toggle="tab">
              <img src="{{firstImageData}}" height="100" width="100"/></a>
            </li>
            <li *ngFor="let imgIdData of otherIdImagesData"><a data-target="#{{imgIdData.id}}" data-toggle="tab">
              <img src="{{imgIdData.imageData}}" height="100" width="100"/></a>
            </li>
          </ul>

        </div>
        <div class="details col-md-6">
          <h3 class="product-title">{{product.name}}</h3>
          <!-- <div class="rating">
            <div class="stars">
              <span class="fa fa-star checked"></span>
              <span class="fa fa-star checked"></span>
              <span class="fa fa-star checked"></span>
              <span class="fa fa-star"></span>
              <span class="fa fa-star"></span>
            </div>
            <span class="review-no">41 reviews</span>
          </div> -->
          <p class="product-description">{{product.description}}</p>
          <h4 class="price">current price: <span>Rs. {{product.price}}</span></h4>
          <!--<p class="vote"><strong>91%</strong> of buyers enjoyed this product! <strong>(87
                                votes)</strong></p>-->
          <!--<h5 class="sizes">sizes:
                            <span class="size" data-toggle="tooltip" title="small">s</span>
                            <span class="size" data-toggle="tooltip" title="medium">m</span>
                            <span class="size" data-toggle="tooltip" title="large">l</span>
                            <span class="size" data-toggle="tooltip" title="xtra large">xl</span>
                        </h5>
                        <h5 class="colors">colors:
                            <span class="color orange not-available" data-toggle="tooltip"
                                title="Not In store"></span>
                            <span class="color green"></span>
                            <span class="color blue"></span>
                        </h5>-->

          <h4 class="sizes">Current Status: <span>{{productStatus}}</span></h4>

          <h5 class="sizes">Category Name:
            <span class="size">{{product.categoryName}}</span>
          </h5>
          <h5 class="sizes">Category Description:
            <span class="size">{{product.categoryDescription}}</span>
          </h5>

          <h5 class="sizes">Posted By:
            <span class="size">{{product.postedBy}}</span>
          </h5>

          <h5 class="sizes">Start Date:
            <span class="size">{{product.startDate}}</span>
          </h5>
          <h5 class="sizes">Start Time:
            <span class="size">{{product.startTime}}</span>
          </h5>
          <h5 class="sizes">End Date:
            <span class="size">{{product.endDate}}</span>
          </h5>
          <h5 class="sizes">End Time:
            <span class="size">{{product.endTime}}</span>
          </h5>

          <div class="row mt-3">
            <div class="col-md-12 text-center text-md-left text-md-right">

              <button class="btn btn-primary btn-rounded" data-toggle="modal" data-target="#exampleModalCenter"
                      [disabled]="product.isExpired || product.isUpcoming || !isUserLogged">
                Bid Now
              </button>
              <button class="btn btn-primary btn-rounded" (click)="addToCart(product.id)"
                      [disabled]="product.isExpired || product.isUpcoming || !product.canAddToCart">
                Add to Cart
              </button>
              <button class="btn btn-primary btn-rounded" (click)="addToCart(product.id)"
                      [disabled]="product.isExpired || product.isUpcoming || !product.canAddToCart">
                Pay Base Price
              </button>

              <a *ngIf="product.orderId" [routerLink]="['/order-detail/',product.orderId]"
                 routerLinkActive="router-link-active"
                 title="Order Details" data-toggle="tooltip">
                <button class="btn btn-primary btn-rounded">Order Details</button>
              </a>

              <button class="btn btn-primary btn-rounded" *ngIf="isOwner"
                      [routerLink]="['/update-product/',product.id]" routerLinkActive="router-link-active">

                <!--<a [routerLink]="['/update-product/',product.id]" routerLinkActive="router-link-active"
                   title="View Details" data-toggle="tooltip">
                  <i class="far fa-edit"></i>&nbsp;&nbsp;<span>Update</span>
                </a>-->

                <i class="far fa-edit"></i>&nbsp;&nbsp;<span>Update</span>
              </button>
            </div>
          </div>


          <!-- <div class="action">
            <button mat-raised-button class="btn btn-default cart" type="button"> Cart</button>
            <button mat-icon-button color="warn" aria-label="Example icon-button with a heart icon">
              <a [routerLink]="['/bid-details']" routerLinkActive="router-link-active">
                <button mat-button class="header-font-color">Bid Details</button>
              </a>

              <mat-icon>favorite</mat-icon>
            </button>
          </div>  -->
        </div>
      </div>
    </div>
    <mat-divider class="divider" style="margin-bottom: 9px;"></mat-divider>

    <div *ngIf="product.isExpired && userWinBid && userWinBid">
      <h2 align="center" class="font-weight-bold p-3 purple-gradient">WINNER</h2>
      <mat-divider class=""></mat-divider>
      <table class="table table-striped table-responsive-md btn-table">
        <thead>
        <tr>
          <th class="font-weight-bold" style="font-size:18px;">User Name</th>
          <th class="font-weight-bold" style="font-size:18px;">Bidder Name</th>
          <th class="font-weight-bold" style="font-size:18px;">Bid Price</th>
          <th class="font-weight-bold" style="font-size:18px;">Bid Date Time</th>
          <th *ngIf="userWinBid.currentUserWon" class="font-weight-bold" style="font-size:18px;">Remaining Price</th>
          <th *ngIf="userWinBid.currentUserWon" class="font-weight-bold" style="font-size:18px;">Remaining Amount</th>
        </tr>
        </thead>

        <tbody>
        <tr>
          <th scope="row" style="font-size:16px;">{{userWinBid.username}}</th>
          <td style="font-size:16px;">{{userWinBid.firstName + userWinBid.lastName}}</td>
          <td style="font-size:16px;">{{userWinBid.bidPrice}}</td>
          <td style="font-size:16px;">{{userWinBid.bidDate}}</td>
          <td *ngIf="userWinBid.currentUserWon" style="font-size:16px;">{{userWinBid.remainingPrice}}</td>
          <td *ngIf="userWinBid.currentUserWon" style="font-size:16px;">
            <button *ngIf="userWinBid.isPaymentRequired" type="button"
                    class="btn btn-teal btn-rounded btn-sm m-0 rounded-pill" [routerLink]="['/billing']"
                    [queryParams]="{ productId: product.id }"
                    routerLinkActive="router-link-active">Pay Remaining Amount
            </button>
            <span *ngIf="!(userWinBid.isPaymentRequired)">No other payment required.</span>
          </td>
        </tr>
        </tbody>
      </table>
      <mat-divider class="" style="margin-bottom: 9px;"></mat-divider>
    </div>

    <div class="description-card">
      <h3 class="product-title">Product All Bids</h3>
      <div class="des-content">
        <app-live-auction [userBids]="userBids"></app-live-auction>
      </div>
    </div>
  </div>
</div>


<!-- Bid -->
<!-- Button trigger modal -->

<!-- Modal -->
<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
     aria-hidden="true">

  <!-- Add .modal-dialog-centered to .modal-dialog to vertically center the modal -->
  <div class="modal-dialog modal-dialog-centered" role="document">

    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">Welcome! Bid Now</h2>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="container-fluid">
          <div class="form-group">
            <div class="center-align col-md-12">
              <form ngNativeValidate (submit)="bid(product.id)">
                <label><h5>Enter Your Bidding Price</h5></label> &nbsp;
                <mat-form-field appearance="fill">
                  <span matPrefix>â‚¹&nbsp;</span>
                  <mat-label>Bid Price</mat-label>
                  <input matInput type="number" name="bidAmount" [(ngModel)]="bidAmount" class="example-right-align"
                         min="{{product.price}}">
                  <!--<span matSuffix class="amount">.00</span>-->
                  <mat-hint class="alert alert-danger" *ngIf="bidErrorMessage">{{bidErrorMessage}}</mat-hint>
                </mat-form-field>
                <button type="submit" class="btn btn-primary col-md-6">BID NOW</button>
              </form>
            </div>

            <li class="alert alert-success" *ngIf="bidSuccessMessage"> {{bidSuccessMessage}}</li>
            <li class="alert alert-danger" *ngIf="bidErrorMessage"> {{bidErrorMessage}}</li>

          </div>
        </div>
      </div>
      <div class="modal-footer">
        <!--<button type="button" class="btn btn-unique">Bid Now</button>&nbsp;&nbsp;&nbsp;-->
        <button type="button" class="btn btn-default" data-dismiss="modal" (click)="refreshPage()">Close</button>
      </div>
    </div>

  </div>
</div>
